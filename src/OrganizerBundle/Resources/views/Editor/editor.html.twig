{% extends 'default/organizer.html.twig' %}
{% block main_attributes %}class="main-editor"{% endblock %}
{% block body_class %}editor{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
{% endblock %}

{% block breadcrumb %}
    <ol class="breadcrumb--list">
        <li class="breadcrumb--list-item"><a href="{{ path('homepage') }}">Organizer</a></li>
        <li class="breadcrumb--list-item"><a href="{{ path('displayRaid', {'id': id}) }}">{{ raidName }}</a></li>
        <li class="breadcrumb--list-item">Éditeur</li>
    </ol>

    <button class="btn-ico" id="editorTutorial" title="Tutoriel"><span>Voir l'aide</span> <i class="fas fa-lightbulb fa-lg"></i></button>
{% endblock %}

{% block body %}
<div class="full-content">
    <div id="editorContainer" class="editor--container">
        <div class="bar">
            <div class="tab-bar">
                <button class="active accordion">Parcours</button>
                <div class="active panel tabcontent" id="tracks-pan">
                    <ul id="editor--list" class="editor--list checkbox-list">
                        <!-- FILLED IN JS-->
                    </ul>
                </div>
                <button class="active accordion">Points d'intéret</button>
                <div class=" panel tabcontent" id="pois-pan">
                    <ul id="list--pois" class="editor--list list--pois">
                        <!-- FILLED IN JS-->
                    </ul>
                </div>
            </div>
            <div class="tab-bar--actions">
                <button aria-label="Fermer la barre latérale" class="btn--laterale-bar" id="btn--laterale-bar">
                    <i class="fas fa-caret-right"></i>
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="map--container">
            <div id="errorMessage" class="editor-error--message"></div>
            <div style="display : none;" class="elevation-tools">
                <canvas id="canvas"></canvas>
                <button class="close-graph-btn">X</button>
            </div>
            <div id="map" class="map"></div>

            <div class="fab">
              <span id="fabActionButton"  class="fab-action-button btn--add-poi">
                <span class="btn--editor">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.85 122.85">
                       <path d="M122.85,48.06q0,12.15-6.75,19.44T96.93,74.79H74.79v48.06q-12.15,0-19.44-6.75T48.06,96.93V74.79H0Q0,62.64,6.75,55.35t19.17-7.29H48.06V0Q60.21,0,67.5,6.75t7.29,19.17V48.06Z" />
                    </svg>
                </span>
              </span>
                <ul class="fab-buttons">
                    <li class="fab-buttons-item">
                        <a href="#" id="addTrackButton" class="fab-buttons-link" data-tooltip="Ajouter un parcours">
                            <img src="{{ asset('assets/images/fab-icon--track.svg') }}" alt="">
                        </a>
                    </li>
                    <li class="fab-buttons-item">
                        <a href="#" id="addPoiButton"  class="fab-buttons-link" data-tooltip="Ajouter un point d'intéret">
                            <img src="{{ asset('assets/images/fab-icon--poi.svg') }}" alt="">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>



    <!-- ADD TRACK  -->
    <div id="add-track-popin" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-track-title" data-micromodal-close>
                <div class="modal-container">
                    <header class="modal--header ">
                        <h2 id="add-track-title">
                            Ajouter un parcours
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="add-track-content" class="modal--content">
                        <div>
                            <form name="addTrack" id="addTrack_form">
                                <div id="addTrack">
                                    <div class="form--item">
                                        <label for="addTrack_name" class="required">
                                            Nom du parcours <span class="input--required">*</span>
                                        </label>
                                        <input class="form--input-text" type="text" id="addTrack_name"
                                               required="required" maxlength="100">
                                    </div>
                                    <div class="form--item form--item-select">
                                        <label for="addTrack_sportType" class="required">
                                            Type de sport <span class="input--required">*</span>
                                        </label>
                                        <select id="addTrack_sportType" required>
                                            {% for sportType in sportTypes %}
                                                <option value="{{ sportType.id }}">{{ sportType.sport }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="form--item">
                                        <label for="addTrack_color" class="required">Couleur <span class="input--required">*</span></label>
                                        <input class="form--input-text" type="color" id="addTrack_color">
                                        <div class="colors">
                                            <button class="btn-color" type="button" title="#f74a45" data-color="#f74a45"></button>
                                            <button class="btn-color" type="button" title="#0f5e54" data-color="#0f5e54"></button>
                                            <button class="btn-color" type="button" title="#333333" data-color="#333333"></button>
                                            <button class="btn-color" type="button" title="#e731ab" data-color="#e731ab"></button>
                                            <button class="btn-color" type="button" title="#2040ae" data-color="#2040ae"></button>
                                            <button class="btn-color" type="button" title="#0080ff" data-color="#0080ff"></button>
                                            <button class="btn-color" type="button" title="#e26e2a" data-color="#e26e2a"></button>
                                            <button class="btn-color" type="button" title="#24e0c6" data-color="#24e0c6"></button>
                                        </div>
                                        <script>
                                            window.addEventListener('load', function() {
                                                if (document.getElementById('addTrack_color') !== null) {
                                                    var colorBtns = document.getElementById('addTrack_color').nextElementSibling.getElementsByClassName('btn-color');

                                                    for (var btn of colorBtns) {
                                                        btn.addEventListener('click', function() {
                                                            document.getElementById('addTrack_color').value = this.dataset.color;
                                                        });
                                                    }
                                                }
                                            });
                                        </script>
                                    </div>
                                    <div class="actions">
                                        <button type="submit" id="addTrack_submit" class="btn">Ajouter un parcours</button>
                                        <button type="button" class="btn btn--danger" data-micromodal-close>Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TRACK SETTINGS -->
    <div id="edit-track-popin" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="edit-track-title" data-micromodal-close>
                <div class="modal-container">
                    <header class="modal--header ">
                        <h2 id="edit-track-title">
                            Éditer un parcours
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="edit-track-content" class="modal--content">
                        <div>
                            <form name="editTrack" id="editTrack_form">
                                <div id="editTrack">
                                    <div class="form--item  form--input-focused">
                                        <label for="editTrack_name" class="required">
                                            Nom du parcours <span class="input--required">*</span>
                                        </label>
                                        <input class="form--input-text" type="text" id="editTrack_name"
                                               required="required" maxlength="100">
                                    </div>
                                    <div class="form--item form--item-select">
                                        <label for="editTrack_sportType" class="required">
                                            Type de sport <span class="input--required">*</span>
                                        </label>
                                        <select id="editTrack_sportType" required>
                                            {% for sportType in sportTypes %}
                                                <option value="{{ sportType.id }}">{{ sportType.sport }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="form--item  form--input-focused">
                                        <label for="editTrack_color" class="required">
                                            Couleur <span class="input--required">*</span></label>
                                        <input class="form--input-text" type="color" id="editTrack_color">
                                        <div class="colors">
                                            <button class="btn-color" type="button" title="#f74a45" data-color="#f74a45"></button>
                                            <button class="btn-color" type="button" title="#0f5e54" data-color="#0f5e54"></button>
                                            <button class="btn-color" type="button" title="#333333" data-color="#333333"></button>
                                            <button class="btn-color" type="button" title="#e731ab" data-color="#e731ab"></button>
                                            <button class="btn-color" type="button" title="#2040ae" data-color="#2040ae"></button>
                                            <button class="btn-color" type="button" title="#0080ff" data-color="#0080ff"></button>
                                            <button class="btn-color" type="button" title="#e26e2a" data-color="#e26e2a"></button>
                                            <button class="btn-color" type="button" title="#24e0c6" data-color="#24e0c6"></button>
                                        </div>
                                        <script>
                                            window.addEventListener('load', function() {
                                                if (document.getElementById('editTrack_color') !== null) {
                                                    var colorBtns = document.getElementById('editTrack_color').nextElementSibling.getElementsByClassName('btn-color');

                                                    for (var btn of colorBtns) {
                                                        btn.addEventListener('click', function() {
                                                            document.getElementById('editTrack_color').value = this.dataset.color;
                                                        });
                                                    }
                                                }
                                            });
                                        </script>
                                    </div>
                                    <input class="form--input-text" type="hidden" id="editTrack_id" >
                                    <div class="actions">
                                        <button type="submit" id="editTrack_submit" class="btn">Mettre à jour</button>
                                        <button type="button" class="btn btn--danger" id="editTrack_delete">Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ADD POI  -->
    <div id="add-poi-popin" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container">
                    <header class="modal--header ">
                        <h2 id="add-poi-title">
                            Nouveau point d'intérêt
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="add-poi-content" class="modal--content">
                        <div>
                            {% if poiTypes is empty %}
                                <div class="alert alert--danger">
                                    <p>Il n'existe aucun type de point d'intérêt.</p>
                                    <p>Pour en ajouter, <a href="{{ path('addPoiType') }}">cliquez ici</a>.</p>
                                </div>
                            {% endif %}

                                <form name="addPoi" id="addPoi_form">
                                <div id="addPoi" class="modal--poi">
                                    <div class="form--item">
                                        <label for="addPoi_name">
                                            Nom du point d'intérêt
                                        </label>
                                        <input class="form--input-text" type="text" id="addPoi_name"
                                                maxlength="45">
                                    </div>
                                    <div class="form--item">
                                        <label for="addPoi_nbhelper">
                                            Nombre de bénévoles requis
                                        </label>
                                        <input class="form--input-text" type="number" id="addPoi_nbhelper" min="0">
                                    </div>
                                    <div class="form--item form--item-select">
                                        <label for="addPoi_type" class="required">
                                            Type du point d'intérêt <span class="input--required">*</span>
                                        </label>
                                        <select id="addPoi_type" required>
                                            {% for poiType in poiTypes %}
                                            <option value="{{ poiType.id }}">{{ poiType.type }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="form--item form--input-focused">
                                        <label for="addPoi_description">
                                            Description
                                        </label>
                                        <input class="form--input-text" type="text" id="addPoi_description">
                                    </div>
                                    <div class="form--item form--input-focused">
                                        <label for="addPoi_image">
                                            Photo
                                        </label>
                                        <input class="form--input-text" type="file" id="addPoi_image">
                                        <img src="" alt="preview" class="form--item-file-hide-preview" id="addPoi_preview"/>
                                    </div>
                                    <div class="form--item form--item-checkbox">
                                        <input type="checkbox" class="form--input-checkbox form--checkbox" id="addPoi_isCheckpoint">
                                        <label for="addPoi_isCheckpoint">
                                            Ce point d'intérêt est un checkpoint
                                        </label>
                                    </div>
                                    <div class="actions">
                                        <button type="submit" id="addPoi_submit">Ajouter</button>
                                        <button type="button" id="addPoi_cancel" class="btn--danger" data-micromodal-close>Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- EDIT POI -->
    <div id="edit-poi-popin" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="edit-poi-title" data-micromodal-close>
                <div class="modal-container">
                    <header class="modal--header ">
                        <h2 id="edit-poi-title">
                            Éditer un point d'intéret
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="edit-poi-content" class="modal--content">
                        <div>
                            <form name="editPoi" id="editPoi_form">
                                <div id="editPoi" class="modal--poi">
                                    <div class="form--item form--input-focused">
                                        <label for="editPoi_name" class="required">
                                            Nom du point d'intérêt <span class="input--required">*</span>
                                        </label>
                                        <input class="form--input-text" type="text" id="editPoi_name"
                                               required="required" maxlength="45">
                                    </div>
                                    <div class="form--item form--input-focused">
                                        <label for="editPoi_nbhelper" class="required">
                                            Nombre de bénévoles requis <span class="input--required">*</span>
                                        </label>
                                        <input class="form--input-text" type="number" id="editPoi_nbhelper" required="required">
                                    </div>
                                    <div class="form--item form--item-select">
                                        <label for="editPoi_type" class="required">
                                            Type du point d'intérêt <span class="input--required">*</span>
                                        </label>
                                        <select id="editPoi_type" required>
                                            {% for poiType in poiTypes %}
                                                <option value="{{ poiType.id }}">{{ poiType.type }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="form--item form--input-focused">
                                        <label for="editPoi_description">
                                            Description
                                        </label>
                                        <input class="form--input-text" type="text" id="editPoi_description">
                                    </div>
                                    <div class="form--item form--input-focused">
                                        <label for="editPoi_image">
                                            Photo
                                        </label>
                                        <input class="form--input-text" type="file" id="editPoi_image">
                                        <img src="" alt="preview" class="form--item-file-hide-preview" id="editPoi_preview"/>
                                    </div>
                                    <div class="form--item form--item-checkbox">
                                        <input type="checkbox" class="form--input-checkbox form--checkbox" id="editPoi_isCheckpoint">
                                        <label for="editPoi_isCheckpoint">
                                            Ce point d'intérêt est un checkpoint
                                        </label>
                                    </div>
                                    <input class="form--input-text" type="hidden" id="editPoi_id" >
                                    <div class="actions">
                                        <button type="submit" id="editPoi_submit" class="btn">Mettre à jour</button>
                                        <button type="button" class="btn btn--danger" data-micromodal-close>Annuler</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- [1] -->
    <div id="delete-track" aria-hidden="true" class="modal modal--danger modal--delete-track" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="delete-track-title" >
                <div class="modal-container">
                    <header class="modal--header modal--header--danger">
                        <h2 id="delete-track-title">
                            Supprimer un parcours
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close class="btn--danger"><i data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="delete-track-content" class="modal--content">
                        <p>Êtes-vous certains de vouloir supprimer ce parcours ?</p>
                        <p class="text--important">Cette action est irréversible.</p>

                        <p>Pour supprimer le parcours, veuillez entrer son nom "<span class="text--medium" id="span--track-name"></span>" dans le champ ci-dessous : </p>

                        <input class="form--input-text" type="text" id="track-name-delete"
                               required="required" maxlength="100">

                        <div class="modal--actions">
                            <button type="button" class="btn btn--danger" id="btn--delete-track"  data-id="" disabled>Supprimer</button>
                            <button data-micromodal-close class="btn btn--cancel">Annuler</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- [1] -->
    <div id="delete-poi" aria-hidden="true" class="modal modal--danger" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="delete-poi-title" >
                <div class="modal-container">
                    <header class="modal--header modal--header--danger">
                        <h2 id="delete-poi-title">
                            Supprimer un point d'intérêt
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close class="btn--danger"><i data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="delete-poi-content" class="modal--content">
                        <p>Êtes-vous certains de vouloir supprimer ce point d'intérêt ?</p>
                        <p class="text--important">Cette action est irréversible.</p>
                        <div class="modal--actions">
                            <button type="button" class="btn btn--danger" id="btn--delete-poi"  data-id="">Supprimer</button>
                            <button data-micromodal-close class="btn btn--cancel">Annuler</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tutorial  -->
    <div id="tutorial_1" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            Bienvenue sur l'éditeur Raidy
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div>
                            <div class="capture-container">
                                <img class="capture" src="{{ asset('assets/images/tutorial/001_Complete.png') }}" alt="">
                            </div>
                            <p>Avant de commencer, nous vous proposons de suivre un rapide <span class="text--important">tutoriel</span>.</p>
                            <p>L'éditeur de carte Raidy vous permettra de préparer votre raid.</p>
                            <p class="text--introducing">Vous pourrez : </p>
                            <ul>
                                <li>Créer et gérer des parcours</li>
                                <li>Créer et gérer des points d'intérêt</li>
                                <li>Importer des fichiers .gpx</li>
                                <li>Exporter des fichiers .gpx</li>
                            </ul>
                        </div>
                        <div class="btn--actions-tutorial">
                            <button class="btn btn--danger" data-micromodal-close>Fermer</button>
                            <button class="btn btn--editor-tutorial" data-id="2" data-current="1">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="tutorial_2" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            L'interface (2)
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div class="capture-container">
                            <img class="capture" src="{{ asset('assets/images/tutorial/001_Complete.png') }}" alt="">
                        </div>
                        <div>
                            <ol class="main-list">
                                <li>
                                    <h2>La barre latérale</h2>
                                    <p>Cette barre latérale liste les différents parcours et points d'intérêt créés. Au clic sur un accordéon, la liste concernée est cachée ou affichée.</p>
                                    <p>Pour chaque item, il y a un menu contextuel qui permet de modifier l'entité concernée ou de la supprimer.</p>
                                </li>
                                <li>
                                    <h2>La carte</h2>
                                    <p>La carte est l'élément le plus important de l'éditeur Raidy, car elle permet de : </p>
                                    <ul>
                                        <li>ajouter des parcours et des points d'intérêt</li>
                                        <li>visualiser les parcours et les points d'inérêt créés</li>
                                        <li>concevoir et modifier des tracés</li>
                                    </ul>
                                </li>
                                <li>
                                    <h2>Le menu d'action</h2>
                                    <p>Le menu d'action permet de travailler sur l'éditeur. Au survol, les différentes actions possibles deviennent accessibles.</p>
                                    <ol>
                                        <li>Création d'un parcours</li>
                                        <li>Création d'un point d'intérêt</li>
                                    </ol>
                                </li>
                            </ol>
                        </div>
                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="1" data-current="2">Précédent</button>
                            <button class="btn btn--editor-tutorial" data-id="3" data-current="2">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="tutorial_3" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            Les parcours (3)
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div class="capture-container">
                            <img class="capture" src="{{ asset('assets/images/tutorial/003_Track.png') }}" alt="">
                        </div>
                        <div>
                            <p>Pour créer un parcours, vous pouvez utiliser le bouton "+" en bas à droite de l'écran et cliquer sur le bouton "Ajouter un parcours".</p>
                            <p>Une fois les informations complétées, vous pouvez commencer à tracer le parcours : </p>
                            <ul>
                                <li>Chaque clic créera un point sur la carte.</li>
                                <li>Double-cliquer sur un point le supprimera.</li>
                                <li>Pour ajuster le parcours, vous pouvez déplacer le point qui vous intéresse.</li>
                                <li>Pour ajouter un point entre 2 autres, vous devez déplacer les poignées translucides présentes entre deux points du parcours.</li>
                                <li>Pour finaliser un parcours, vous pouvez cliquer sur le dernier point créé.</li>
                            </ul>
                            <p>Pour terminer l'édition d'un parcours, vous pouvez cliquer sur le bouton rouge en bas à droite de l'écran.</p>
                        </div>

                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="2" data-current="3">Précédent</button>
                            <button class="btn btn--editor-tutorial" data-id="4" data-current="3">Suivant</button>
                            <!--<button class="btn btn--danger" data-micromodal-close>Terminer</button>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="tutorial_4" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            Les points d'intérêt (4)
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div class="capture-container">
                            <img class="capture" src="{{ asset('assets/images/tutorial/002_POI.png') }}" alt="">
                        </div>
                        <div>
                            <p>Les points d'intérêt sont des emplacements importants liés à l'organisation d'un raid.</p>
                            <p>Ils sont tous associés à un type (virage dangereux, buvette, ...) que vous créez en amont <a href="{{ path('addPoiType') }}" title="Créer des types de points d'intérêt - Nouvelle fenêtre" target="_blank">sur cette page</a>.</p>
                            <p>Pour créer un point d'intérêt, vous devez utiliser le bouton "+" en bas à droite de l'écran et cliquer sur le bouton "Ajouter un point d'intérêt".</p>
                            <p>Pour le positionner, il suffit de cliquer sur la carte puis de compléter les informations du formulaire qui s'affichera.</p>
                            <ul>
                                <li>Pour annuler l'ajout d'un point d'intérêt, vous pouvez cliquer sur le bouton rouge en bas à droite de l'écran.</li>
                                <li>Pour déplacer les points d'intérêt, il faut cliquer sur le bouton en haut à droite de la fenêtre.</li>
                                <li>Au clic sur un point d'intérêt, les informations qui y sont relatives s'affichent.</li>
                            </ul>
                        </div>

                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="3" data-current="4">Précédent</button>
                            <button class="btn btn--editor-tutorial" data-id="5" data-current="4">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="tutorial_5" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            L'import de fichiers GPX (5)
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div class="capture-container">
                            <img class="capture" src="{{ asset('assets/images/tutorial/004_Import.png') }}" alt="">
                        </div>
                        <div>
                            <p>L’éditeur Raidy vous propose de créer automatiquement vos raids grâce à l’import de fichiers GPX. Les fichiers GPX sont des fichiers standardisés.</p>
                            <p>Au clic sur l’icône <i class="fas fa-file-import"></i>, une fenêtre s’ouvrira. Il vous faudra alors sélectionner à partir de vos fichiers, le fichier .gpx que vous souhaitez importer.</p>
                        </div>

                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="4" data-current="5">Précédent</button>
                            <button class="btn btn--editor-tutorial" data-id="6" data-current="5">Suivant</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="tutorial_6" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            L'export de fichiers GPX (6)
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div class="capture-container">
                            <img class="capture" src="{{ asset('assets/images/tutorial/005_Export.png') }}" alt="">
                        </div>
                        <div>
                            <p>L’éditeur Raidy vous permet d’exporter la totalité d’un raid sous format GPX.
                                Au clic sur l’icône <i class="fas fa-file-export"></i>, vous devez choisir le format “Route” ou “Tracé” sous lequel votre raid sera exporté automatiquement.
                            </p>
                        </div>
                        <div>
                            <h2>Fin du tutoriel</h2>
                            <p>Vous savez désormais tout ce qu'il y a à savoir sur l'éditeur Raidy. Vous pouvez consulter à tout moment ces informations en cliquant sur l'icône <i class="fas fa-lightbulb"></i> disponible au-dessus de la carte.</p>
                        </div>

                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="5" data-current="6">Précédent</button>
                            <button class="btn btn--danger" data-micromodal-close>Terminer</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="tutorial_7" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="add-poi-title" data-micromodal-close>
                <div class="modal-container modal-tutorial">
                    <header class="modal--header ">
                        <h2>
                            Fin du tutoriel
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i
                                    data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div class="modal--content">
                        <div>
                            <p>Vous savez désormais tout ce qu'il y a à savoir sur l'éditeur Raidy. Vous pouvez consulter à tout moment ces informations en cliquant sur l'icône <i class="fas fa-lightbulb"></i> disponible au-dessus de la carte.</p>
                        </div>
                        <div class="btn--actions-tutorial">
                            <button class="btn btn--editor-tutorial" data-id="6" data-current="7">Précédent</button>
                            <button class="btn btn--danger" data-micromodal-close>Terminer</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Import GPX -->
    <div id="import-gpx" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="delete-poi-title" >
                <div class="modal-container">
                    <header class="modal--header modal--header--danger">
                        <h2 id="delete-poi-title">
                            Importer un fichier GPX
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="import-gpx-content" class="modal--content">
                        <form id="import-gpx--form" class="gpx-import--form">
                            <input type="file" id="import-gpx--input">

                            <div id="import-gpx--tracks" class="import-gpx--category">
                                <h3>Tracés</h3>
                                <div class="import-gpx--checkboxes"></div>
                            </div>
                            <div id="import-gpx--routes" class="import-gpx--category">
                                <h3>Routes</h3>
                                <div class="import-gpx--checkboxes"></div>
                            </div>
                            <div id="import-gpx--waypoints" class="import-gpx--category">
                                <h3>Points de passages</h3>
                                <div class="import-gpx--checkboxes"></div>
                            </div>
                            <div class="actions">
                                <button type="submit" class="btn btn--action">Importer</button>
                                <button type="button" class="btn btn--danger" data-micromodal-close>Annuler</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Export GPX -->
    <div id="export-gpx" aria-hidden="true" class="modal" data-micromodal-close>
        <!-- [2] -->
        <div tabindex="-1" data-micromodal-close>
            <!-- [3] -->
            <div role="dialog" aria-modal="true" aria-labelledby="delete-poi-title" >
                <div class="modal-container">
                    <header class="modal--header modal--header--danger">
                        <h2 id="delete-poi-title">
                            Exporter un fichier GPX
                        </h2>
                        <!-- [4] -->
                        <button aria-label="Fermer la fenêtre" data-micromodal-close><i data-micromodal-close class="fas fa-times"></i></button>
                    </header>
                    <div id="export-gpx-content" class="modal--content">
                        <div class="actions">
                            <button class="btn btn--action" id="export-gpx--track">Exporter en tant que tracés GPX</button>
                            <button class="btn btn--action" id="export-gpx--route">Exporter en tant que routes GPX</button>
                            <button type="button" class="btn btn--danger" data-micromodal-close>Annuler</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script>
        let mapManager;
        let raidID;
        document.addEventListener("DOMContentLoaded", function () {
            mapManager = new MapManager();
            raidID = "{{ id }}";
            mapManager.initialize();
        });
    </script>

    <script>
        document.getElementById('track-name-delete').addEventListener('keyup', function() {
            if (document.getElementById('track-name-delete').dataset.name === this.value) {
                document.getElementById('btn--delete-track').disabled = false;
            } else {
                document.getElementById('btn--delete-track').disabled = true;
            }
        });
    </script>

    {% if app.user.tutorialTime is null %}
        <script>
            var tutorial = true;
        </script>
    {% else %}
        <script>
            var tutorial = false;
        </script>
    {% endif %}
{% endblock %}

